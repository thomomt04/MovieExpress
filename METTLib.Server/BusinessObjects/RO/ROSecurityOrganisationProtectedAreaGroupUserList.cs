// Generated 05 Nov 2018 10:41 - Singular Systems Object Generator Version 2.2.694
//<auto-generated/>
using System;
using Csla;
using Csla.Serialization;
using Csla.Data;
using System.ComponentModel;
using System.ComponentModel.DataAnnotations;
using Singular;
using System.Data;
using System.Data.SqlClient;


namespace METTLib.RO
{
	[Serializable]
	public class ROSecurityOrganisationProtectedAreaGroupUserList
	 : METTReadOnlyListBase<ROSecurityOrganisationProtectedAreaGroupUserList, ROSecurityOrganisationProtectedAreaGroupUser>
	{
		#region " Business Methods "

		public ROSecurityOrganisationProtectedAreaGroupUser GetItem(int SecurityOrganisationProtectedAreaGroupUserId)
		{
			foreach (ROSecurityOrganisationProtectedAreaGroupUser child in this)
			{
				if (child.SecurityOrganisationProtectedAreaGroupUserId == SecurityOrganisationProtectedAreaGroupUserId)
				{
					return child;
				}
			}
			return null;
		}

		public override string ToString()
		{
			return "Security Organisation Protected Area Group Users";
		}

		#endregion

		#region " Data Access "

		[Serializable]
		public class Criteria
			: CriteriaBase<Criteria>
		{
			public int? userID = null;
			public int? organisationID = null;
			public int? protectedAreaID = null;

			public Criteria(int? UserID, int? OrganisationID, int? ProtectedAreaID)
			{
				this.userID = UserID;
				this.organisationID = OrganisationID;
				this.protectedAreaID = ProtectedAreaID;
			}

			public Criteria()
			{
			}

		}

		public static ROSecurityOrganisationProtectedAreaGroupUserList NewROSecurityOrganisationProtectedAreaGroupUserList()
		{
			return new ROSecurityOrganisationProtectedAreaGroupUserList();
		}

		public ROSecurityOrganisationProtectedAreaGroupUserList()
		{
			// must have parameter-less constructor
		}

		public static ROSecurityOrganisationProtectedAreaGroupUserList GetROSecurityOrganisationProtectedAreaGroupUserList()
		{
			return DataPortal.Fetch<ROSecurityOrganisationProtectedAreaGroupUserList>(new Criteria());
		}

		public static ROSecurityOrganisationProtectedAreaGroupUserList GetROSecurityOrganisationProtectedAreaGroupUserList(int? UserID, int? OrganisationID, int? ProtectedAreaID)
		{
			return DataPortal.Fetch<ROSecurityOrganisationProtectedAreaGroupUserList>(new Criteria(UserID, OrganisationID, ProtectedAreaID));
		}

		protected void Fetch(SafeDataReader sdr)
		{
			this.RaiseListChangedEvents = false;
			this.IsReadOnly = false;
			while (sdr.Read())
			{
				this.Add(ROSecurityOrganisationProtectedAreaGroupUser.GetROSecurityOrganisationProtectedAreaGroupUser(sdr));
			}
			this.IsReadOnly = true;
			this.RaiseListChangedEvents = true;
		}

		protected override void DataPortal_Fetch(Object criteria)
		{
			Criteria crit = (Criteria)criteria;
			using (SqlConnection cn = new SqlConnection(Singular.Settings.ConnectionString))
			{
				cn.Open();
				try
				{
					using (SqlCommand cm = cn.CreateCommand())
					{
						cm.CommandType = CommandType.StoredProcedure;
						cm.CommandText = "GetProcs.getROSecurityOrganisationProtectedAreaGroupUserList";

						cm.Parameters.AddWithValue("@UserID", Singular.Misc.NothingDBNull(crit.userID));
						cm.Parameters.AddWithValue("@OrganisationID", Singular.Misc.NothingDBNull(crit.organisationID));
						cm.Parameters.AddWithValue("@ProtectedAreaID", Singular.Misc.NothingDBNull(crit.protectedAreaID));

						using (SafeDataReader sdr = new SafeDataReader(cm.ExecuteReader()))
						{
							Fetch(sdr);
						}
					}
				}
				finally
				{
					cn.Close();
				}
			}
		}

		#endregion

	}

}